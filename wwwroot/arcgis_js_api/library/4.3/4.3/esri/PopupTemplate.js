// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.3/esri/copyright.txt for details.
//>>built
define(["./core/JSONSupport","./core/kebabDictionary","./core/Collection","./core/lang","./support/Action"],function(l,e,m,c,n){var g=e({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),f=e({shortDate:"short-date",shortDateLE:"short-date-le",longDate:"long-date",dayShortMonthYear:"day-short-month-year",longMonthDayYear:"long-month-day-year",shortDateLongTime:"short-date-long-time",shortDateLELongTime:"short-date-le-long-time",shortDateShortTime:"short-date-short-time",shortDateLEShortTime:"short-date-le-short-time",
shortDateShortTime24:"short-date-short-time-24",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLongTime24:"short-date-long-time-24",shortDateLELongTime24:"short-date-le-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year"}),h=e({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"}),k=l.createSubclass({properties:{actions:{type:m.ofType(n)},content:{value:null,json:{read:{source:["description","popupElements","mediaInfos",
"showAttachments"]}}},fieldInfos:{value:null},overwriteActions:{value:!1},title:{value:""},relatedRecordsInfo:{value:null}},declaredClass:"esri.PopupTemplate",actions:null,content:"",fieldInfos:null,_fieldInfosReader:function(a){return this._readFieldInfos(a)},overwriteActions:!1,title:"",relatedRecordsInfo:null,_relatedRecordsInfoReader:function(a){return a?c.clone(a):a},_dateFormatKebabDict:f,clone:function(){var a=this.actions;a&&(a=c.clone(a.toArray()));return new k({actions:a||[],content:Array.isArray(this.content)?
c.clone(this.content):this.content,fieldInfos:this.fieldInfos?c.clone(this.fieldInfos):null,overwriteActions:this.overwriteActions,relatedRecordsInfo:this.relatedRecordsInfo?c.clone(this.relatedRecordsInfo):null,title:this.title})},toJSON:function(){var a={showAttachments:!1,title:this.title};this.fieldInfos&&(a.fieldInfos=this._writeFieldInfos(c.clone(this.fieldInfos)));this.relatedRecordsInfo&&(a.relatedRecordsInfo=c.clone(this.relatedRecordsInfo));var b=this.content;"string"===typeof b?a.description=
b:Array.isArray(b)&&(a.popupElements=c.clone(b),a.popupElements.forEach(function(b){"attachments"!==b.type||a.showAttachments?"media"!==b.type||a.mediaInfos?"text"!==b.type||a.description?"fields"!==b.type||a.fieldInfos||(b.fieldInfos&&(a.fieldInfos=this._writeFieldInfos(c.clone(b.fieldInfos))),delete b.fieldInfos):(b.text&&(a.description=b.text),delete b.text):(b.mediaInfos&&(a.mediaInfos=c.clone(b.mediaInfos),a.mediaInfos.forEach(function(b){b.type=h.toJSON(b.type)})),delete b.mediaInfos):a.showAttachments=
!0;return b}.bind(this)));return a},_contentReader:function(a,b){a=b.description;var d=[],c=b.popupElements;c&&c.length?d=c.map(function(a){"text"!==a.type||a.text?"media"===a.type&&(a.mediaInfos||b.mediaInfos)&&(a.mediaInfos||(a.mediaInfos=b.mediaInfos),a.mediaInfos=this._readMediaInfos(a.mediaInfos)):a.text=b.description;return a}.bind(this)):(b.description?d.push({type:"text",text:b.description}):d.push({type:"fields"}),b.mediaInfos&&b.mediaInfos.length&&d.push({type:"media",mediaInfos:this._readMediaInfos(b.mediaInfos)}),
b.showAttachments&&d.push({type:"attachments",displayType:"list"}));d.length&&(a=d);return a},_readFieldInfos:function(a){a&&a.forEach(function(a){var b=a.format&&a.format.dateFormat,c=a.stringFieldOption;b&&(a.format.dateFormat=f.fromJSON(b));c&&(a.stringFieldOption=g.fromJSON(c))});return a},_writeFieldInfos:function(a){a.forEach(function(a){var b=a.format&&a.format.dateFormat,c=a.stringFieldOption;b&&(a.format.dateFormat=f.toJSON(b));c&&(a.stringFieldOption=g.toJSON(c));a.format||delete a.format});
return a},_readMediaInfos:function(a){a.forEach(function(a){a.type=h.fromJSON(a.type)});return a}});return k});