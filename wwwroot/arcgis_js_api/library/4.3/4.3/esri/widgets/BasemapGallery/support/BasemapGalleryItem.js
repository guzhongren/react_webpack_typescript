// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.3/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/watchUtils ../../../core/Accessor ../../../core/HandleRegistry".split(" "),function(b,k,e,d,a,f,g,h){b=function(b){function a(){var c=null!==b&&b.apply(this,arguments)||this;c._handles=new h;c.compatibilityFunction=null;c.error=null;c.state="loading";c.view=null;return c}e(a,b);a.prototype.initialize=function(){var c=this;this._handles.add(f.init(this,
["basemap.loadStatus","compatibilityFunction","view.basemapTerrain.tilingScheme","view.ready","view.spatialReference"],function(){return c.refresh()}))};a.prototype.destroy=function(){this._cancelCompatibilityCheck();this._handles.destroy();this.view=this.compatibilityFunction=this.basemap=this._handles=null};Object.defineProperty(a.prototype,"basemap",{set:function(c){var a=this._get("basemap");a&&a.cancelLoad();c&&c.load();this._set("basemap",c)},enumerable:!0,configurable:!0});a.prototype.refresh=
function(){var a=this;this._cancelCompatibilityCheck();this._set("state","loading");var b=this.get("basemap.loadStatus");if("loaded"===b||"failed"===b)if(this.compatibilityFunction){var d=!1,e=this.compatibilityFunction(this).then(function(){d||(a._set("state","ready"),a._set("error",null))}).otherwise(function(b){d||(a._set("state","error"),a._set("error",b))});this._lastCompatibilityCheck={cancel:function(){d=!0;e.cancel()}}}else"loaded"===b?(this._set("state","ready"),this._set("error",null)):
(this._set("state","error"),this._set("error",this.basemap.loadError))};a.prototype._cancelCompatibilityCheck=function(){this._lastCompatibilityCheck&&(this._lastCompatibilityCheck.cancel(),this._lastCompatibilityCheck=null)};return a}(a.declared(g));d([a.property()],b.prototype,"basemap",null);d([a.property()],b.prototype,"compatibilityFunction",void 0);d([a.property({readOnly:!0})],b.prototype,"error",void 0);d([a.property({readOnly:!0})],b.prototype,"state",void 0);d([a.property()],b.prototype,
"view",void 0);return b=d([a.subclass("esri.widgets.BasemapGallery.support.BasemapGalleryItem")],b)});