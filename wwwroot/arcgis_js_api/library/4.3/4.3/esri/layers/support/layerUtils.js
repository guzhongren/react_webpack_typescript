// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.3/esri/copyright.txt for details.
//>>built
define(["dojo/_base/array"],function(f){return{_serializeLayerDefinitions:function(a){var b=[],c=!1,e=/[:;]/;if(a&&(f.forEach(a,function(a,d){a&&(b.push([d,a]),!c&&e.test(a)&&(c=!0))}),0<b.length)){var d;c?(d={},f.forEach(b,function(a){d[a[0]]=a[1]}),d=JSON.stringify(d)):(d=[],f.forEach(b,function(a){d.push(a[0]+":"+a[1])}),d=d.join(";"));return d}return null},_serializeTimeOptions:function(a,b){if(a){var c=[];f.forEach(a,function(a,d){a&&(a=a.toJSON(),b&&-1!==f.indexOf(b,d)&&(a.useTime=!1),c.push('"'+
d+'":'+JSON.stringify(a)))});if(c.length)return"{"+c.join(",")+"}"}},_getVisibleLayers:function(a,b){var c=[],e,d;if(!a)return c;if(b)for(c=b.concat(),d=0;d<a.length;d++)b=a[d],e=f.indexOf(a,b.id),b.subLayerIds&&-1<e&&(c.splice(e,1),c=c.concat(b.subLayerIds));else c=this._getDefaultVisibleLayers(a);return c},_getDefaultVisibleLayers:function(a){var b=[],c;if(!a)return b;for(c=0;c<a.length;c++)0<=a[c].parentLayerId&&-1===f.indexOf(b,a[c].parentLayerId)&&f.some(a,function(b){return b.id===a[c].parentLayerId})||
a[c].defaultVisibility&&b.push(a[c].id);return b},_getLayersForScale:function(a,b){var c=[];if(0<a&&b){var e;for(e=0;e<b.length;e++)if(!(0<=b[e].parentLayerId&&-1===f.indexOf(c,b[e].parentLayerId)&&f.some(b,function(a){return a.id===b[e].parentLayerId}))&&0<=b[e].id){var d=!0,g=b[e].maxScale,h=b[e].minScale;if(0<g||0<h)0<g&&0<h?d=g<=a&&a<=h:0<g?d=g<=a:0<h&&(d=a<=h);d&&c.push(b[e].id)}}return c}}});