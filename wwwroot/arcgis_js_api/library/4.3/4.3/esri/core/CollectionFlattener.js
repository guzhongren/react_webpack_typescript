// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.3/esri/copyright.txt for details.
//>>built
define("require exports ./tsSupport/declareExtendsHelper ./tsSupport/decorateHelper ./accessorSupport/decorators ./Collection ./HandleRegistry".split(" "),function(b,m,k,g,f,h,l){b=function(b){function d(a){a=b.call(this)||this;a._handles=new l;a.root=null;a.refresh=a.refresh.bind(a);a.updateCollections=a.updateCollections.bind(a);return a}k(d,b);d.prototype.initialize=function(){var a=this;this._handles.add(this.rootCollectionNames.map(function(e){return a.watch("root."+e,a.updateCollections,!0)}));
this.updateCollections()};d.prototype.destroy=function(){this.root=null;this.refresh();this._handles.destroy();this._handles=null};d.prototype.updateCollections=function(){var a=this;this._collections=this.rootCollectionNames.map(function(e){return a.get("root."+e)}).filter(function(a){return null!=a});this.refresh()};d.prototype.refresh=function(){var a=this._handles;a.remove("collections");this.removeAll();for(var e=this._collections.slice(),c=0,b=this._collections;c<b.length;c++)this._processCollection(e,
this,b[c]);for(c=0;c<e.length;c++)a.add(e[c].on("after-changes",this.refresh),"collections")};d.prototype._createNewInstance=function(a){return new h(a)};d.prototype._processCollection=function(a,b,c){var d=this;c&&(a.push(c),c.forEach(function(c){c&&(b.push(c),d._processCollection(a,b,d.getChildrenFunction(c)))}))};return d}(f.declared(h));g([f.property()],b.prototype,"rootCollectionNames",void 0);g([f.property()],b.prototype,"root",void 0);g([f.property()],b.prototype,"getChildrenFunction",void 0);
return b=g([f.subclass("esri.core.CollectionFlattener")],b)});