// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.3/esri/copyright.txt for details.
//>>built
define(["dojo/_base/lang","./mathUtils","../../../geometry/Point","../../../geometry/SpatialReference","../../../geometry/support/webMercatorUtils"],function(k,d,g,l,n){var h=6378137*Math.PI,f=new g(0,0,l.WGS84),m={earthRadius:6378137,halfEarthCircumference:h,earthCircumference:2*h,metersPerDegree:h/180,getGreatCircleDistance:function(a,b,c,e){void 0===c&&void 0===e&&k.isObject(a)&&k.isObject(b)&&(c=b.get("longitude"),e=b.get("latitude"),b=a.get("latitude"),a=a.get("longitude"));b=d.deg2rad(b);e=
d.deg2rad(e);a=d.deg2rad(a);var p=d.deg2rad(c);c=Math.sin((b-e)/2);a=Math.sin((a-p)/2);b=12756274*d.asin(Math.sqrt(c*c+Math.cos(b)*Math.cos(e)*a*a));return b=Math.round(1E4*b)/1E4},getGreatCircleSpanAt:function(a,b,c){var e=b.spatialReference,d=new g(b.x,a.y,e),f=new g(c.x,a.y,e);b=new g(a.x,b.y,e);a=new g(a.x,c.y,e);return{lon:this.getGreatCircleDistance(d,f),lat:this.getGreatCircleDistance(b,a)}},getLonDeltaForDistance:function(a,b,c){a=c/6378137;b=d.deg2rad(b);a=Math.sin(a/2);b=Math.cos(b);b=2*
d.asin(Math.sqrt(a*a/(b*b)));return d.rad2deg(b)},getLatDeltaForDistance:function(a,b,c){return d.rad2deg(c/6378137)},getLatLonDeltaForDistance:function(a,b,c){return{lat:this.getLatDeltaForDistance(a,b,c),lon:this.getLonDeltaForDistance(a,b,c)}},getMaxCameraAltitude:function(a){a=d.deg2rad(a/2);return 6378137*(1-Math.sin(a))/Math.sin(a)},getViewExtentDistance:function(a,b){b=d.deg2rad(b/2);return 12756274*d.acos((Math.pow(a+6378137,2)+Math.pow(6378137,2)-Math.pow((a+6378137)*Math.cos(b)-Math.sqrt(Math.pow(Math.cos(b)*
(a+6378137),2)-a*a-12756274*a),2))/(12756274*(a+6378137)))},computeCarthesianDistance:function(a,b){function c(a){var b=d.deg2rad(a.get("latitude")),c=d.deg2rad(a.get("longitude")),e=Math.cos(b);a=6378137+(a.z||0);return[Math.cos(c)*e*a,Math.sin(b)*a,-Math.sin(c)*e*a]}a=c(a);b=c(b);b=[b[0]-a[0],b[1]-a[1],b[2]-a[2]];return Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2])},longitudeToTimezone:function(a,b){a/=15;b||(a=Math.round(a));return a},positionToTimezone:function(a,b){a.spatialReference.wkid!==l.WGS84.wkid?
n.webMercatorToGeographic(a,!1,f):(f.x=a.x,f.y=a.y);f.z=a.z;b||(b={hours:0,minutes:0,seconds:0});b.hours=m.longitudeToTimezone(f.x,!0);a=b.hours%1;b.hours-=a;b.minutes=60*a;a=b.minutes%1;b.minutes-=a;b.seconds=Math.round(60*a);return b}};return m});