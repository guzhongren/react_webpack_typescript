// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.3/esri/copyright.txt for details.
//>>built
define(["require","exports","./Program","./Util","./ShaderSourceVariator"],function(m,n,k,h,l){return function(){function b(a,c,d,f,b,e){"string"===typeof a?this._initParams(a,c,d,f,b,e):this._initObject({programNamePrefix:a.programNamePrefix,shaderSnippetPrefixes:a.shaderSnippetPrefixes,baseDefines:a.baseDefines,snippets:a.snippets,rctx:a.rctx,vertexAttribLocs:a.vertexAttribLocs})}b.prototype._initObject=function(a){this._initParams(a.programNamePrefix,a.shaderSnippetPrefixes,a.baseDefines,a.snippets,
a.rctx,a.vertexAttribLocs)};b.prototype._initParams=function(a,c,d,f,b,e){this._defaultSnippets=f;this._defaultRctx=b;this._defaultVertexAttribLocs=e;this._sealed=!1;this._programCache=new Map;this._shaderSourceVariator=new l(a,c,d)};b.prototype.addDefine=function(a,c,d,b){this._shaderSourceVariator.addDefine(a,c,d,b)};b.prototype.addBinaryShaderSnippetSuffix=function(a,c,d){this._shaderSourceVariator.addBinaryShaderSnippetSuffix(a,c,d)};b.prototype.addNaryShaderSnippetSuffix=function(a,c){this._shaderSourceVariator.addNaryShaderSnippetSuffix(a,
c)};b.prototype.getProgram=function(a,c,d,b){c=c||this._defaultSnippets;d=d||this._defaultRctx;b=b||this._defaultVertexAttribLocs;if(!c)throw Error("No ShaderSnippets provided to getProgram nor to ShaderVariations constructor.");if(!d)throw Error("No RenderingContext provided to getProgram nor to ShaderVariations constructor.");if(!b)throw Error("No VertexAttributeLocations provided to getProgram nor to ShaderVariations constructor.");this._sealed=!0;var f=a.reduce(function(a,b){return a+b.toString()},
"");if(this._programCache[f])return this._programCache[f];a=this._shaderSourceVariator.getShaderVariation(a);var e,g;e=a.shaderSnippetNames[0];g=c[e];h.assert(null!=g,"shader snippet '"+e+"' does not exist");e=a.shaderSnippetNames[1];c=c[e];h.assert(null!=c,"shader snippet '"+e+"' does not exist");d=new k(d,g,c,b,a.defines);return this._programCache[f]=d};return b}()});