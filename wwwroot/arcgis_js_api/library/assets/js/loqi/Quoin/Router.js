/*! ArcGIS API for JavaScript 4.3 | Copyright (c) 2017 Esri. All rights reserved. | http://www.esri.com/legal/privacy | https://developers.arcgis.com/terms/faq */
define(["dojo/_base/declare","dojo/_base/lang","dojox/lang/functional/object","dojo/Evented","dojo/topic","Quoin/History","Quoin/Base"],function(e,t,o,r,n,i,u){var a=/\((.*?)\)/g,s=/(\(\?)?:\w+/g,c=/\*\w+/g,h=/[\-{}\[\]+?.,\\\^$|#\s]/g,f=e("Quoin.Router",[r,u],{route:function(e,o,r){return e instanceof RegExp||(e=this._routeToRegExp(e)),i.route(e,t.hitch(this,function(t){var n=this._extractParameters(e,t),u={name:o,args:n};r&&r.apply(this,n),this.emit("route:"+o,u),this.emit("route",u),i.emit("route",u)})),this},navigate:function(e,t){return i.navigate(e,t),this},_bindRoutes:function(){if(this.routes)for(var e,t=o.keys(this.routes);null!==(e=t.pop());)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(h,"\\$&").replace(a,"(?:$1)?").replace(s,function(e,t){return t?e:"([^/]+)"}).replace(c,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});return new f});