/*! ArcGIS API for JavaScript 4.3 | Copyright (c) 2017 Esri. All rights reserved. | http://www.esri.com/legal/privacy | https://developers.arcgis.com/terms/faq */
require(["SessionManager","esri/request","dojo/query","esri/core/urlUtils","dojo/_base/event","dojo/NodeList-manipulate"],function(e,n,o,i,t){function r(e){o("body").append('<iframe src="'+e+'" style="display:none;"></iframe>')}function a(n,o){return esri.request({url:SiteConfig.download_server+"/dms/rest/download/secured/"+n,content:{token:e.token(),folder:o}}).then(function(e){if(200===e.code)return e.url},function(e){})}function l(n,o){if(e.loggedIn()){var i=e.organization&&e.organization.subscriptionInfo?e.organization.subscriptionInfo.type:"Public";a(n,o).then(r),ga("send","event","SDK Downloads","File Download",n),ga("send","event","SDK Downloads","Account Type",i)}else e.redirect("/sign-in",{redirect_uri:window.location.href.replace(window.location.search,"")+"?filename="+n+"&folder="+o})}function d(e){var n=i.urlToObject(window.location.href).query;n&&n.filename&&n.folder&&(l(n.filename,n.folder),history.replaceState({},"",location.pathname))}o(".download-link").on("click",function(e){t.stop(e);var n=o(this),i=n.attr("data-filename")[0],r=n.attr("data-folder")[0];l(i,r)}),d()});